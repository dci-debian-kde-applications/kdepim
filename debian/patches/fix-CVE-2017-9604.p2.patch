From c54706e990bbd6498e7b1597ec7900bc809e8197 Mon Sep 17 00:00:00 2001
From: Montel Laurent <montel@kde.org>
Date: Fri, 2 Jun 2017 13:56:41 +0200
Subject: Make sure to sign/encrypt message when we send later

(cherry picked from commit 4048f5e46d0a7d62d93d74fd2861dd70fb2ad660)
---
 messagecomposer/composer/composerviewbase.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/messagecomposer/composer/composerviewbase.cpp
+++ b/messagecomposer/composer/composerviewbase.cpp
@@ -288,7 +288,7 @@ void MessageComposer::ComposerViewBase::
         }
     }
 
-    if ( m_neverEncrypt && saveIn != MessageComposer::MessageSender::SaveInNone ) {
+    if ( m_neverEncrypt && saveIn != MessageComposer::MessageSender::SaveInNone && !mSendLaterInfo) {
         // we can't use the state of the mail itself, to remember the
         // signing and encryption state, so let's add a header instead
         m_msg->setHeader( new KMime::Headers::Generic( "X-KMail-SignatureActionEnabled", m_msg.get(),
